---
{"dg-publish":true,"dg-permalink":"设计一个分布式锁","permalink":"/设计一个分布式锁/"}
---


#分布式 #软件设计 

1. 互斥性
	- 同一时间只能有**一个**节点持有锁
	- 实现：Redis 的 **setnx**
2. 原子性
	- set(key, value, NX, EX, ...)
	- Lua 脚本
3. 避免出现死锁
	- 即使持有锁的节点宕机，锁也会被释放
	- 实现：给锁加上**超时时间**
4. 唯一性&可重入性
	- 不能有误删的情况发生
	- 实现：给锁加上**唯一标识**
5. 容错性
	- 只要大多数 Redis 结点正常，就可以获取锁
	- 实现：集群**高可用**
6. 锁等待
	- **发布订阅机制**通知等待锁的线程