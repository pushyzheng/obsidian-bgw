---
{"dg-publish":true,"dg-permalink":"IO 多路复用算法","permalink":"/IO 多路复用算法/"}
---


## select

通过**位图**[^1]表示监听的 fd 集合，**内核**轮询 fs 集合是否就绪。

缺点：最大监听 fd 有限制（默认 1024），每次调用都要从内核态复制数据，轮询效率低。

## poll

与 [[src/计算机基础/IO 多路复用算法#select\|select]] 的区别在于数据结构变为**数组**，没有 fd 数量的限制。

缺点：**仍需**用户态和内核态拷贝，轮询效率低

## epoll

**事件驱动**模型，**内核维护**就绪事件的 fd 就绪事件链表。

只有**活跃的** fd 才通知用户，避免轮询，使用 [[src/计算机基础/操作系统#什么是 mmap？\|mmap]] 减少用户态与内核态拷贝。

数据结构：
- **红黑树**：待检测的 fd，为了提高查询效率
- **链表**：就绪的 fd，为了减少轮询

[^1]: 位图（bitmask），用来表示一组文件描述符的集合。它通过一组整数（通常是 unsigned long 数组）中的每一位来标记对应的文件描述符是否被包含在集合中
